syntax = "proto3";

option csharp_namespace = "TradeBot.Account.AccountService.v1";

package tradebot.account.account_service.v1;

service AcountService {
	//Сервис для входа в аккаунт или его регистрации.
	rpc Login (LoginRequest) returns (LoginReply); //Метод входа в аккаунт
	rpc Register (RegisterRequest) returns (RegisterReply); //Метод регистрации аккаунта
	rpc IsValidSession (SessionRequest) returns (SessionReply); //Проверка текущего пользователя на валидность по Id сессии
	rpc CurrentUserData (SessionRequest) returns (CurrentUserReply); //Получение данных текущего пользователя
}

message LoginRequest {
	//Данные для входа в аккаунт.
	string username = 1;
	string password = 2;
}

message LoginReply {
	//Ответ на запрос о входе в аккаунт.
	ActionCode result = 1;
	string message = 2;
	int32 session_id = 3;
}

message RegisterRequest {
	//Данные для регистрации аккаунта.
	string username = 1;
	string email = 2;
	int32 phone_number = 3;
	string password = 4;
	string verify_password = 5;
}

message RegisterReply {
	//Ответ на запрос о регистрации аккаунта.
	ActionCode result = 1;
	string message = 2;
}

message SessionRequest {
	//Запрос на передачу сессии.
	int32 session_id = 1;
}

message SessionReply {
	//Результат проверки сессии на валидность.
	bool is_valid = 1;
	string message = 2;
}

message CurrentUserReply {
	//Получение данных текущего пользователя.
	ActionCode result = 1;
	string message = 2;
	UserInfo current_user = 3;
}

message UserInfo {
	//Информация о пользователе, необходимая для отображения в UI
	int32 id = 1;
	string username = 2;
	string email = 3;
	int32 phone_number = 4;
}

enum ActionCode {
	/*
	* Код результата выполнения входа или регистрации:
	* 0 - успешное выполнение,
	* 1 - пользователь не найден,
	* 2 - пользователь уже существует,
	* 3 - имеется пустое поле ввода,
	* 4 - пароли не совпадают.
	*/
	ACTION_CODE_SUCCESSFUL = 0;
	ACTION_CODE_USER_NOT_FOUND = 1;
	ACTION_CODE_USER_EXISTS = 2;
	ACTION_CODE_EMPTY_FIELD = 3;
	ACTION_CODE_PASSWORD_MISMATCH = 4;
	ACTION_CODE_IS_NOT_EMAIL = 5;
}